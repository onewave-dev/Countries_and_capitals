# Telegram Bot ¬´–°—Ç–æ–ª–∏—Ü—ã –º–∏—Ä–∞ ‚Äî —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞¬ª (AGENTS.md)

–°–¥–µ–ª–∞—Ç—å Telegram-–±–æ—Ç–∞ —Å –≤–µ–±—Ö—É–∫–æ–º (**FastAPI**), —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ —á–µ—Ç—ã—Ä–µ —Ä–µ–∂–∏–º–∞ –æ–±—É—á–µ–Ω–∏—è/—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è–º **—Å—Ç—Ä–∞–Ω–∞ ‚Üî —Å—Ç–æ–ª–∏—Ü–∞**.

---

## –ü–†–ê–í–ò–õ–ê –ò –†–ï–ñ–ò–ú–´

–ë–æ—Ç –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—É—á–∏—Ç—å –∏ –Ω–∞—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è **—Å—Ç—Ä–∞–Ω–∞ ‚Üî —Å—Ç–æ–ª–∏—Ü–∞** —á–µ—Ç—ã—Ä—å–º—è –∫–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏. –í–æ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å **–∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç** (–ï–≤—Ä–æ–ø–∞ / –ê–∑–∏—è / –ê—Ñ—Ä–∏–∫–∞ / –°–µ–≤–µ—Ä–Ω–∞—è –ê–º–µ—Ä–∏–∫–∞ / –Æ–∂–Ω–∞—è –ê–º–µ—Ä–∏–∫–∞ / –ê–≤—Å—Ç—Ä–∞–ª–∏—è –∏ –û–∫–µ–∞–Ω–∏—è / –í–µ—Å—å –º–∏—Ä) –∏ **—Ç–∏–ø –≤–æ–ø—Ä–æ—Å–æ–≤**:
- *–°—Ç—Ä–∞–Ω–∞ ‚Üí —Å—Ç–æ–ª–∏—Ü–∞*;
- *–°—Ç–æ–ª–∏—Ü–∞ ‚Üí —Å—Ç—Ä–∞–Ω–∞* ‚Äî –≤–æ–ø—Ä–æ—Å —Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ—Ç—Å—è: ¬´–°—Ç–æ–ª–∏—Ü–µ–π –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω—ã —è–≤–ª—è–µ—Ç—Å—è **–ü–∞—Ä–∞–º–∞—Ä–∏–±–æ**?¬ª;
- *–°–º–µ—à–∞–Ω–Ω—ã–π* (–æ–±–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–ø–µ—Ä–µ–º–µ—à–∫—É).

### 1) ¬´–§–ª—ç—à-–∫–∞—Ä—Ç–æ—á–∫–∏¬ª (–æ–±—É—á–µ–Ω–∏–µ, 1 –∏–≥—Ä–æ–∫)

- –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É:
  - ¬´üáπüá≠ –¢–∞–∏–ª–∞–Ω–¥ ‚Üí ?¬ª (–µ—Å–ª–∏ *—Å—Ç—Ä–∞–Ω–∞ ‚Üí —Å—Ç–æ–ª–∏—Ü–∞*)
  - ¬´–°—Ç–æ–ª–∏—Ü–µ–π –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω—ã —è–≤–ª—è–µ—Ç—Å—è **–ë–∞–Ω–≥–∫–æ–∫**?¬ª (–µ—Å–ª–∏ *—Å—Ç–æ–ª–∏—Ü–∞ ‚Üí —Å—Ç—Ä–∞–Ω–∞*)
  - –í —Å–º–µ—à–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–¥—É–µ—Ç—Å—è.
- –ü–æ–¥ –∫–∞—Ä—Ç–æ—á–∫–æ–π ‚Äî **—á–µ—Ç—ã—Ä–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞**, –∞ —Ç–∞–∫–∂–µ –∫–Ω–æ–ø–∫–∏ ¬´–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç¬ª, ¬´–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å¬ª, ¬´–ó–∞–≤–µ—Ä—à–∏—Ç—å¬ª.
- –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ ¬´‚úÖ‚ÄØ–í–µ—Ä–Ω–æ¬ª –∏–ª–∏ ¬´‚ùå‚ÄØ–ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ‚Ä¶¬ª –±–µ–∑ –∏–Ω–ª–∞–π–Ω‚Äë–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã. –ü—Ä–∏ –≤–µ—Ä–Ω–æ–º –æ—Ç–≤–µ—Ç–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã, —Å—Ç—Ä–æ–∫–∞ ¬´–°—Ç–æ–ª–∏—Ü–∞: {capital}¬ª (–µ—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –ø—Ä–æ —Å—Ç–æ–ª–∏—Ü—É) –∏ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞ –∏–∑ `assets/flags/{iso}_flag.png`. –ó–∞—Ç–µ–º –±–æ—Ç –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π —Ñ–∞–∫—Ç –∏–∑ `data/facts_st.json` (–ø–æ —Ç—Ä–∏ —Ñ–∞–∫—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω—É) –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –µ–≥–æ –≤–º–µ—Å—Ç–µ —Å –∫–Ω–æ–ø–∫–æ–π ¬´–ï—â–µ –æ–¥–∏–Ω —Ñ–∞–∫—Ç¬ª. –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç LLM, –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–æ–≤—ã–º —Ñ–∞–∫—Ç–æ–º –∏ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–∫—Ç; –∫–∞–∂–¥—ã–π —Ñ–∞–∫—Ç ‚â§150 —Å–∏–º–≤–æ–ª–æ–≤.
- –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å–µ—Å—Å–∏–∏ –±–æ—Ç –≤—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ ¬´**–Ω–µ–∏–∑—É—á–µ–Ω–Ω—ã—Ö**¬ª (–Ω–µ–≤–µ—Ä–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã) –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∏—Ö –æ—Ç–¥–µ–ª—å–Ω–æ.

### 2) ¬´–ò–≥—Ä–∞ –Ω–∞ –≤—Ä–µ–º—è¬ª (—Å–ø—Ä–∏–Ω—Ç, 1 –∏–≥—Ä–æ–∫)

- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è ‚Äî **60 —Å–µ–∫—É–Ω–¥**.
- –ü–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ: ¬´–£ —Ç–µ–±—è –±—É–¥–µ—Ç 60 —Å–µ–∫—É–Ω–¥, —á—Ç–æ–±—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ¬ª.
- –°–µ—Ä–∏—è –±—ã—Å—Ç—Ä—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ (–∫–Ω–æ–ø–∫–∏ 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞). –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Äî —Å–º–µ—à–∞–Ω–Ω–æ–µ.
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ ¬´‚úÖ‚ÄØ–í–µ—Ä–Ω–æ¬ª –∏–ª–∏ ¬´‚ùå‚ÄØ–ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ‚Ä¶¬ª –±–µ–∑ –∏–Ω–ª–∞–π–Ω‚Äë–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã. –ü—Ä–∏ –≤–µ—Ä–Ω–æ–º –æ—Ç–≤–µ—Ç–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã, —Å—Ç—Ä–æ–∫–∞ ¬´–°—Ç–æ–ª–∏—Ü–∞: {capital}¬ª (–µ—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –ø—Ä–æ —Å—Ç–æ–ª–∏—Ü—É) –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞.
- –ó–∞ –∫–∞–∂–¥—ã–π –≤–µ—Ä–Ω—ã–π ‚Äî +1 –æ—á–∫–æ.
- –ö–Ω–æ–ø–∫–∞ ¬´–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å¬ª –¥–æ–ø—É—Å—Ç–∏–º–∞ –∏ –¥–∞—ë—Ç **0 –æ—á–∫–æ–≤**.
- –§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥: ¬´‚è± –í—Ä–µ–º—è –≤—ã—à–ª–æ! –í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: **14 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–∑ 18**\n\n–ß—Ç–æ –±—ã–ª–æ –Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:\nüáπüá≠ –¢–∞–∏–ª–∞–Ω–¥ ‚Äî –ë–∞–Ω–≥–∫–æ–∫\n‚Ä¶¬ª.

### 3) ¬´–î—É—ç—Ç –ø—Ä–æ—Ç–∏–≤ –ë–æ—Ç–∞: —Å—Ç–æ–ª–∏—Ü—ã –º–∏—Ä–∞¬ª (–∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤, 2 –∏–≥—Ä–æ–∫–∞)

- –ó–∞–ø—É—Å–∫ –≤ –≥—Ä—É–ø–ø–æ–≤–æ–º —á–∞—Ç–µ: **/coop_capitals**.  
  –ü–µ—Ä–≤—ã–µ –¥–≤–æ–µ, –∫—Ç–æ –∂–º—É—Ç ¬´üôã –£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å¬ª, —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è **–ò–≥—Ä–æ–∫–æ–º 1** –∏ **–ò–≥—Ä–æ–∫–æ–º 2**.
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏: —á–∏—Å–ª–æ —Ä–∞—É–Ω–¥–æ–≤ (5/10/15), —Å–ª–æ–∂–Ω–æ—Å—Ç—å –±–æ—Ç–∞-—Å–æ–ø–µ—Ä–Ω–∏–∫–∞:
  - üü¢ –õ—ë–≥–∫–∏–π ‚âà 30% –≤–µ—Ä–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤;
  - üü° –°—Ä–µ–¥–Ω–∏–π ‚âà 60%;
  - üî¥ –°–ª–æ–∂–Ω—ã–π ‚âà 80%.
- –ö–∞–∂–¥—ã–π —Ä–∞—É–Ω–¥: –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –≤–æ–ø—Ä–æ—Å –Ω–∞ –¥–≤–æ–∏—Ö ‚Üí –ò–≥—Ä–æ–∫ 1 –æ—Ç–≤–µ—á–∞–µ—Ç, –∑–∞—Ç–µ–º –ò–≥—Ä–æ–∫ 2 (–∫–Ω–æ–ø–∫–∏ 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞).
  –í–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç –∏–≥—Ä–æ–∫–∞ ‚Üí **+1 –æ—á–∫–æ –ö–æ–º–∞–Ω–¥–µ**.
  –ó–∞—Ç–µ–º –æ—Ç–≤–µ—á–∞–µ—Ç ¬´–±–æ—Ç-—Å–æ–ø–µ—Ä–Ω–∏–∫¬ª (–≤–µ—Ä–Ω–æ/–Ω–µ–≤–µ—Ä–Ω–æ –ø–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏) ‚Üí **+1 –æ—á–∫–æ –ë–æ—Ç—É** –ø—Ä–∏ –≤–µ—Ä–Ω–æ–º –æ—Ç–≤–µ—Ç–µ.
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –∂–∏–≤–æ–π –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ ¬´‚úÖ‚ÄØ–í–µ—Ä–Ω–æ¬ª –∏–ª–∏ ¬´‚ùå‚ÄØ–ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ‚Ä¶¬ª –±–µ–∑ –∏–Ω–ª–∞–π–Ω‚Äë–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã. –ü—Ä–∏ –≤–µ—Ä–Ω–æ–º –æ—Ç–≤–µ—Ç–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã, —Å—Ç—Ä–æ–∫–∞ ¬´–°—Ç–æ–ª–∏—Ü–∞: {capital}¬ª (–µ—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –ø—Ä–æ —Å—Ç–æ–ª–∏—Ü—É) –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞.
- –í—Ä–µ–º—è –Ω–∞ —Ö–æ–¥ –∂–∏–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞ ‚Äî **–Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ**.
- –ú–µ–∂–¥—É —Ä–∞—É–Ω–¥–∞–º–∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø–∞—É–∑–∞ 2‚Äì3 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏.  
- –ò—Ç–æ–≥ —Ä–∞—É–Ω–¥–∞ (–ø—Ä–∏–º–µ—Ä):
  ```
  –í–æ–ø—Ä–æ—Å: –ö–∞–∫–∞—è —Å—Ç–æ–ª–∏—Ü–∞ —É –ù–∏–≥–µ—Ä–∏–∏?
  –ò–≥—Ä–æ–∫ 1 ‚Üí –õ–∞–≥–æ—Å ‚ùå
  –ò–≥—Ä–æ–∫ 2 ‚Üí –ê–±—É–¥–∂–∞ ‚úÖ
  –ë–æ—Ç-—Å–æ–ø–µ—Ä–Ω–∏–∫ ‚Üí ¬´–õ–∞–≥–æ—Å¬ª ‚ùå
  –°—á—ë—Ç: –ö–æ–º–∞–Ω–¥–∞ 5 ‚Äî –ë–æ—Ç 3 (–†–∞—É–Ω–¥ 6/10)
  ```
- –ü–æ–±–µ–∂–¥–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞ –∏–ª–∏ –±–æ—Ç –ø–æ –∏—Ç–æ–≥–æ–≤–æ–º—É —Å—á—ë—Ç—É.

### 4) ¬´–£—á–∏—Ç—å –ø–æ —Å–ø–∏—Å–∫—É —Å—Ç—Ä–∞–Ω¬ª

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç.
- –ë–æ—Ç –≤—ã–≤–æ–¥–∏—Ç –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º —Å–ø–∏—Å–æ–∫ –≤–∏–¥–∞ ¬´{—ç–º–æ–¥–∑–∏ —Ñ–ª–∞–≥} {—Å—Ç—Ä–∞–Ω–∞} - –°—Ç–æ–ª–∏—Ü–∞: {—Å—Ç–æ–ª–∏—Ü–∞}¬ª.
- –í –∫–æ–Ω—Ü–µ ‚Äî –∫–Ω–æ–ø–∫–∏ ¬´–î—Ä—É–≥–æ–π –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç¬ª –∏ ¬´–í –º–µ–Ω—é¬ª.

---

## üéØ –¶–µ–ª—å

–°–¥–µ–ª–∞—Ç—å Telegram-–±–æ—Ç–∞ —Å –≤–µ–±—Ö—É–∫–æ–º (**FastAPI**), –∫–æ—Ç–æ—Ä—ã–π:

- –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —á–µ—Ç—ã—Ä–µ —Ä–µ–∂–∏–º–∞: **–§–ª—ç—à-–∫–∞—Ä—Ç–æ—á–∫–∏**, **–ò–≥—Ä–∞ –Ω–∞ –≤—Ä–µ–º—è**, **–î—É—ç—Ç –ø—Ä–æ—Ç–∏–≤ –ë–æ—Ç–∞**, **–£—á–∏—Ç—å –ø–æ —Å–ø–∏—Å–∫—É —Å—Ç—Ä–∞–Ω**;
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç–∞–º –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º –≤–æ–ø—Ä–æ—Å–æ–≤ (*—Å—Ç—Ä–∞–Ω–∞ ‚Üí —Å—Ç–æ–ª–∏—Ü–∞*, *—Å—Ç–æ–ª–∏—Ü–∞ ‚Üí —Å—Ç—Ä–∞–Ω–∞*, *—Å–º–µ—à–∞–Ω–Ω—ã–π*);
- —Ö—Ä–∞–Ω–∏—Ç –±–∞–∑–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–ª—å–∫–æ **–≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏** (—É—Å–ø–µ—Ö–∏ –≤ —Å–ø—Ä–∏–Ω—Ç–µ, —Å–ø–∏—Å–æ–∫ ¬´–∫ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—é¬ª);
- —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –º–∞—Ç—á 2√óBot —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –æ—á–µ—Ä–µ–¥–Ω–æ—Å—Ç–∏, –ø–∞—É–∑–∞–º–∏ –º–µ–∂–¥—É —Ä–∞—É–Ω–¥–∞–º–∏ –∏ —á–µ—Å—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–ª–∏–∫–æ–≤;
- –∏–º–µ–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –∞–¥–º–∏–Ω-–≤–µ—Ä—Å–∏—é –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (—Å–º. –¥–∞–ª–µ–µ).

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**FastAPI**
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `POST /webhook` (–∞–ø–¥–µ–π—Ç—ã Telegram).
- –°–ª—É–∂–µ–±–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã:  
  `GET /healthz`, `GET /set_webhook`, `GET /reset_webhook`.

**python-telegram-bot v20+**
- –°–æ–∑–¥–∞–Ω–∏–µ `Application` –≤ –∂–∏–∑–Ω–µ–Ω–Ω–æ–º —Ü–∏–∫–ª–µ FastAPI.
- `job_queue` –¥–ª—è —Ç–∞–π–º–µ—Ä–æ–≤ (—Å–ø—Ä–∏–Ω—Ç, –ø–∞—É–∑—ã –º–µ–∂–¥—É —Ä–∞—É–Ω–¥–∞–º–∏).
- –ê–ø–¥–µ–π—Ç—ã –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `application.process_update(update)`.

**–ú–æ–¥–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è**
- ¬´Hub-and-Spoke¬ª –≥–∏–±—Ä–∏–¥:
  - –û–¥–∏–Ω–æ—á–Ω—ã–µ —Ä–µ–∂–∏–º—ã (–∫–∞—Ä—Ç–æ—á–∫–∏, —Å–ø—Ä–∏–Ω—Ç) –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ **–ª–∏—á–∫–∞—Ö** —Å –±–æ—Ç–æ–º.
  - –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è –≤ **–≥—Ä—É–ø–ø–æ–≤–æ–º —á–∞—Ç–µ** (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è), –Ω–æ –æ—Ç–≤–µ—Ç—ã –∏–≥—Ä–æ–∫–æ–≤ –∏–¥—É—Ç –Ω–∞ **–∫–Ω–æ–ø–∫–∏** –ø–æ–¥ ¬´—è–∫–æ—Ä–Ω—ã–º¬ª —Å–æ–æ–±—â–µ–Ω–∏–µ–º –≤ —Ç–æ–º –∂–µ —á–∞—Ç–µ. –ë–æ—Ç ‚Äî ¬´—Ö–∞–±¬ª: –≤–µ–¥—ë—Ç –º–∞—Ç—á –∏ —Å—á—ë—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å.

**–°–æ—Å—Ç–æ—è–Ω–∏–µ**
- –û–¥–∏–Ω–æ—á–Ω—ã–µ —Å–µ—Å—Å–∏–∏ ‚Äî –≤ `user_data` (–ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞—Ä—Ç–æ—á–µ–∫, —Å–ø—Ä–∏–Ω—Ç).
- –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏ ‚Äî –≤ `chat_data['sessions'][session_id]`:
  - —É—á–∞—Å—Ç–Ω–∏–∫–∏, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Ç—á–∞ (–∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç, —Ç–∏–ø –≤–æ–ø—Ä–æ—Å–æ–≤, —Å–ª–æ–∂–Ω–æ—Å—Ç—å), —Ç–µ–∫—É—â–∏–π —Ä–∞—É–Ω–¥, —á—å—è –æ—á–µ—Ä–µ–¥—å, —Å—á—ë—Ç –∫–æ–º–∞–Ω–¥—ã –∏ –±–æ—Ç–∞, –∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∂–æ–±—ã —Ç–∞–π–º–µ—Ä–æ–≤.
- –î–ª—è Render Free –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞; –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–æ–∑–∂–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ë–î.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ**
- –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å `allowed_updates=[]` –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤–µ–±—Ö—É–∫–∞.
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–∏—Å–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤–µ–±—Ö—É–∫ –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ-—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π health-check –≤–µ–±—Ö—É–∫–∞.
- –ù–µ —É–¥–∞–ª—è—Ç—å –≤–µ–±—Ö—É–∫ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ ‚Äî Telegram –ø–æ–¥–Ω–∏–º–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ –Ω–æ–≤–æ–º—É –∞–ø–¥–µ–π—Ç—É.
- –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö –∫–æ–æ–ø-–º–∞—Ç—á–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å `session_id` –∏ `player_id` –≤ `callback_data` (–∏–≥–Ω–æ—Ä —Ç—Ä–µ—Ç—å–∏—Ö –ª–∏—Ü).
- –î–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è UI ¬´–≥–∞—Å–∏—Ç—å¬ª –∫–Ω–æ–ø–∫–∏ (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è) –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏ –≤ DEBUG (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—á–∞, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–∞, –ø–æ–¥—Å—á—ë—Ç –æ—á–∫–æ–≤, –ø–∞—É–∑—ã).

---

## üì¶ –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

### DataSource (–¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω/—Å—Ç–æ–ª–∏—Ü)
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∏–∑ `capitals.json`.  
- `countries_by_continent: dict[Continent, set[Country]]`
- `capital_by_country: dict[Country, Capital]`
- `country_by_capital: dict[Capital, Country]`
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –∑–∞–ø—Ä–æ—Å—É –¥–ª—è –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏.  
- –ê–ª–∏–∞—Å—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

### CardSession (—Ñ–ª—ç—à-–∫–∞—Ä—Ç–æ—á–∫–∏, –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- `user_id`
- `continent_filter`
- `mode` (*country_to_capital | capital_to_country | mixed*)
- `queue` (–∏—Ç–µ—Ä–∞—Ç–æ—Ä/—Å–ø–∏—Å–æ–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è)
- `unknown_set` (ID —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏)
- `stats` (–ø–æ–∫–∞–∑—ã/–∑–Ω–∞–Ω–∏—è)

### SprintSession (—Å–ø—Ä–∏–Ω—Ç, –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- `user_id`
- `duration_sec` (60)
- `start_ts`
- `continent_filter`, `mode`
- `score`, `questions_asked`
- `wrong_answers`
- `current` (—Ç–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å)

### CoopMatch (–∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤, –Ω–∞ —á–∞—Ç/–≥—Ä—É–ø–ø—É)
- `session_id`
- `players: list[PlayerRef]` (—Ä–æ–≤–Ω–æ –¥–≤–æ–µ), `turn_index` (0/1)
- `bot_difficulty` (0.3/0.6/0.8)
- `rounds_total`, `rounds_played`
- `score_team`, `score_bot`
- `continent_filter`, `mode`
- `anchor_message_id` (—è–∫–æ—Ä—å —Å –∫–Ω–æ–ø–∫–∞–º–∏ –∏ —Ç–∞–±–ª–æ)
- `active_job_ids` (–ø–∞—É–∑—ã –º–µ–∂–¥—É —Ä–∞—É–Ω–¥–∞–º–∏)
- `current_question` (+ –≤–∞—Ä–∏–∞–Ω—Ç—ã, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç)

### PlayerRef
- `user_id`
- `display_name`

---

## ‚ñ∂Ô∏è –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤

- –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: `capitals.json`.  
  –°–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–∞–Ω—ã, —Å—Ç–æ–ª–∏—Ü—ã, —Ä–∞–∑–±–∏–≤–∫—É –ø–æ –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç–∞–º.  
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–∞:
  1) —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç—É,  
  2) –≤—ã–±–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–µ—Å–ª–∏ ¬´mixed¬ª),  
  3) –≤—ã–±–æ—Ä –ø–∞—Ä—ã (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç),  
  4) –ø–æ–¥–±–æ—Ä **3 –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö, –Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö** –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏–∑ —Ç–æ–≥–æ –∂–µ –ø—É–ª–∞,  
  5) —Å–ª—É—á–∞–π–Ω–∞—è –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞.
- –î–ª—è –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞ ‚Äî –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –≤–æ–ø—Ä–æ—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–±–æ–∏–º –∏–≥—Ä–æ–∫–∞–º; –±–æ—Ç-—Å–æ–ø–µ—Ä–Ω–∏–∫ ¬´–æ—Ç–≤–µ—á–∞–µ—Ç¬ª –∑–∞—Ç–µ–º –ø–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å).

---

## ‚ñ∂Ô∏è –ü–æ—Ç–æ–∫–∏ —Ä–µ–∂–∏–º–æ–≤

### –§–ª—ç—à-–∫–∞—Ä—Ç–æ—á–∫–∏
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –ª–∏—á–∫–µ –≤—ã–±–∏—Ä–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç, —Ä–µ–∂–∏–º –≤–æ–ø—Ä–æ—Å–æ–≤) –∏ –∂–º—ë—Ç ¬´–°—Ç–∞—Ä—Ç¬ª.
2. –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É —Å —á–µ—Ç—ã—Ä—å–º—è –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–∞; –¥–æ—Å—Ç—É–ø–Ω—ã ¬´–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç¬ª –∏ ¬´–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å¬ª.
3. –í–µ–¥—ë—Ç—Å—è `unknown_set`; –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ ‚Äî –æ—Ç—á—ë—Ç –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å ¬´–Ω–µ–∏–∑—É—á–µ–Ω–Ω—ã–µ¬ª.

### –ò–≥—Ä–∞ –Ω–∞ –≤—Ä–µ–º—è
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 60 —Å), –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç, —Ä–µ–∂–∏–º –≤–æ–ø—Ä–æ—Å–æ–≤.
2. –°—Ç–∞—Ä—Ç: –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–∞–π–º–µ—Ä —á–µ—Ä–µ–∑ `job_queue`.
3. –°–µ—Ä–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏; —Å—á—ë—Ç—á–∏–∫ –≤–µ—Ä–Ω—ã—Ö/–æ—à–∏–±–æ–∫.
4. –ü–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–∞–π–º–µ—Ä–∞ ‚Äî ¬´‚è± –í—Ä–µ–º—è –≤—ã—à–ª–æ!¬ª –∏ –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

### –î—É—ç—Ç –ø—Ä–æ—Ç–∏–≤ –ë–æ—Ç–∞
1. –í –≥—Ä—É–ø–ø–µ `/coop_capitals` ‚Üí —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤.
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ç—á-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (—Ä–∞—É–Ω–¥—ã, —Å–ª–æ–∂–Ω–æ—Å—Ç—å, —Ñ–∏–ª—å—Ç—Ä—ã).
3. –ö–∞–∂–¥—ã–π —Ä–∞—É–Ω–¥: –≤–æ–ø—Ä–æ—Å ‚Üí –æ—Ç–≤–µ—á–∞–µ—Ç –ò–≥—Ä–æ–∫ 1 ‚Üí –æ—Ç–≤–µ—á–∞–µ—Ç –ò–≥—Ä–æ–∫ 2 ‚Üí –æ—Ç–≤–µ—á–∞–µ—Ç ¬´–±–æ—Ç-—Å–æ–ø–µ—Ä–Ω–∏–∫¬ª.
4. –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –æ—á–∫–æ–≤, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç —Ä–∞—É–Ω–¥–∞, –ø–∞—É–∑–∞ 2‚Äì3 —Å–µ–∫, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–æ.
5. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ —á–∏—Å–ª—É —Ä–∞—É–Ω–¥–æ–≤ ‚Üí –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏ –∫–Ω–æ–ø–∫–∞ ¬´üîÑ –°—ã–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞¬ª.

---

## üì¶ –¢–µ—Å—Ç–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –∏–≥—Ä—ã (–∞–¥–º–∏–Ω)

–î–æ–±–∞–≤–∏—Ç—å **—Ç–µ—Å—Ç–æ–≤—É—é –∞–¥–º–∏–Ω-–≤–µ—Ä—Å–∏—é –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞** (—Ç–æ–ª—å–∫–æ –¥–ª—è `ADMIN_ID`), –∑–∞–ø—É—Å–∫–∞–µ–º—É—é –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π/–∫–æ–º–∞–Ω–¥–æ–π:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞-–±–æ—Ç–∞ –∫–∞–∫ ¬´–¥–∞–º–º–∏-—É—á–∞—Å—Ç–Ω–∏–∫–∞¬ª.
- –î–∞–º–º–∏ –æ—Ç–≤–µ—á–∞–µ—Ç —Å—Ç—Ä–æ–≥–æ –ø–æ **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, 50%).
- –û—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∞ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤—É.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ app.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ AGENTS.md
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ flags/                 # –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–ª–∞–≥–æ–≤ {iso}_flag.png
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ capitals.json           # –¥–∞–Ω–Ω—ã–µ: —Å—Ç—Ä–∞–Ω—ã, —Å—Ç–æ–ª–∏—Ü—ã, –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ handlers_cards.py       # —Ñ–ª—ç—à-–∫–∞—Ä—Ç–æ—á–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ handlers_sprint.py      # –∏–≥—Ä–∞ –Ω–∞ –≤—Ä–µ–º—è
‚îÇ   ‚îú‚îÄ‚îÄ handlers_coop.py        # –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤ 2√óBot
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py
‚îÇ   ‚îú‚îÄ‚îÄ questions.py            # –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤/–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ state.py                # –º–æ–¥–µ–ª–∏ —Å–µ—Å—Å–∏–π/–º–∞—Ç—á–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ facts.py                # —Ñ–∞–∫—Ç—ã: `data/facts_st.json` + LLM
‚îÇ   ‚îî‚îÄ‚îÄ utils.py                # —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```

---

## üìú requirements.txt

```txt
python-telegram-bot>=20.6
fastapi>=0.110
uvicorn[standard]>=0.30
pydantic>=2.6
```

*(–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏: `orjson` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ JSON, `python-dotenv` –¥–ª—è .env.)*

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –ª–æ–∫–∞–ª—å–Ω–æ

1) –°–æ–∑–¥–∞—Ç—å `.env` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Å–º. –Ω–∏–∂–µ).  
2) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```
3) –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä:
```bash
uvicorn app:app --host 0.0.0.0 --port 8000
```
4) –ü—Ä–æ–±—Ä–æ—Å–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π HTTPS-URL (ngrok / cloudflared).  
5) –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–µ–±—Ö—É–∫:
```bash
GET /set_webhook
```

---

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Render (Free)

1) –°–æ–∑–¥–∞—Ç—å **Web Service** –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å GitHub-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.  
2) –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
- **Build Command**
```bash
pip install -r requirements.txt
```
- **Start Command**
```bash
uvicorn app:app --host 0.0.0.0 --port $PORT
```
- **Env Vars**: —Å–º. –Ω–∏–∂–µ.
3) –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ—Ç–∫—Ä—ã—Ç—å:
```text
https://<service>.onrender.com/set_webhook
```

---

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ**
- `TELEGRAM_BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –æ—Ç @BotFather  
- `PUBLIC_URL` ‚Äî –ø—É–±–ª–∏—á–Ω—ã–π HTTPS-URL —Å–µ—Ä–≤–∏—Å–∞  
- `WEBHOOK_SECRET` ‚Äî –¥–ª–∏–Ω–Ω–∞—è —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞  
- `WEBHOOK_PATH` ‚Äî –ø—É—Ç—å –≤–µ–±—Ö—É–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `/webhook`)
- `OPENAI_API_KEY` ‚Äî –∫–ª—é—á OpenAI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∞–∫—Ç–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ**
- `ADMIN_ID` ‚Äî Telegram ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ –∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥)
- `DEFAULT_LOCALE` ‚Äî `ru`
- `LOG_LEVEL` ‚Äî `INFO` / `DEBUG`
 
## ü§ñ –§–∞–∫—Ç—ã

- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `data/facts_st.json` ‚Äî –ø–æ —Ç—Ä–∏ —Ñ–∞–∫—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω—É.
- –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–∫—Ç –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ –∏–∑ —ç—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞.
- –ü–æ—Å–ª–µ —Ñ–∞–∫—Ç–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ ¬´–ï—â–µ –æ–¥–∏–Ω —Ñ–∞–∫—Ç¬ª, –Ω–∞–∂–∞—Ç–∏–µ –≤—ã–∑—ã–≤–∞–µ—Ç LLM –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.
- LLM-—Ñ–∞–∫—Ç –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 150 —Å–∏–º–≤–æ–ª–∞–º–∏.

---

## üîê –ó–∞–º–µ—á–∞–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —á–µ—Å—Ç–Ω–æ—Å—Ç–∏

- –í –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ –Ω–∞–∂–∞—Ç–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç **—Ç–æ–ª—å–∫–æ** –æ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤ (`player_id` –≤ `callback_data`).
- ¬´–ì–∞—Å–∏—Ç—å¬ª –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è).
- –•—Ä–∞–Ω–∏—Ç—å `session_id` –≤ `callback_data`, –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø–æ `chat_id`.
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ –ø–æ `ADMIN_ID`.
- –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏: –ª–æ–≤–∏—Ç—å `telegram.error.RetryAfter` –∏ –¥–µ–ª–∞—Ç—å backoff –ø—Ä–∏ `429`.

## üí° –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

- –í–µ–±—Ö—É–∫ (`telegram_webhook`) –¥–æ–ª–∂–µ–Ω –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å **200 OK**; `Update.de_json` –∏ `application.process_update` –æ–±—ë—Ä–Ω—É—Ç—ã –≤ `try/except`.
- –í—Å–µ –≤—ã–∑–æ–≤—ã `context.bot.*` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `send_message`, `edit_message_text`) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ `try/except` (`telegram.error.TelegramError` –∏–ª–∏ `httpx.HTTPError`) —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º.
- –°–µ—Ä–≤–µ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ—Ä–Ω–µ–≤–æ–π –º–∞—Ä—à—Ä—É—Ç `/` (–∏–ª–∏ `/healthz`), –æ—Ç–≤–µ—á–∞—é—â–∏–π **200** –¥–ª—è health-check.
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –µ—Å–ª–∏ `get_webhook_info().last_error_message` –Ω–µ –ø—É—Å—Ç–æ–π, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `delete_webhook(drop_pending_updates=True)` –∏ –∑–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤–µ–±—Ö—É–∫–∞.

---

## üß™ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- –í–∫–ª—é—á–∏—Ç—å DEBUG-–ª–æ–≥–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Ç–æ—á–∫–∞–º:
  - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤–µ–±—Ö—É–∫–∞,
  - —Å—Ç–∞—Ä—Ç —Å–µ—Å—Å–∏–π/–º–∞—Ç—á–µ–π,
  - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–∞/–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤,
  - –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –æ—á–∫–æ–≤,
  - —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø–∞—É–∑ –º–µ–∂–¥—É —Ä–∞—É–Ω–¥–∞–º–∏,
  - —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –∏—Ç–æ–≥–∏.
- –õ–æ–≥–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é: –∞–≥—Ä–µ–≥–∞—Ü–∏—è —Å—á—ë—Ç–∞ –≤ —Å–ø—Ä–∏–Ω—Ç–µ, —Ä–∞–∑–º–µ—Ä ¬´unknown_set¬ª –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö.
